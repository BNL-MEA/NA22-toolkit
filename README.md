# NA22-toolkit

The BNL Nuclear Engineering Materials for Energy Applications group has developed a robust, interactive python code to process the XRF data collected at SRX. At the beamline, the graphical user interface program developed at SRX, pyXRF, provides preliminary data analysis and confirmation of results during beamtime. PyXRF is well suited for broad spectrum analysis for use when given unknown compositions. Using this approach, we determine the general elements present during data collection – regardless of the signal originating from background, impurities, or the sample.   

Our analysis framework and the constitutive python functions facilitate more detailed analysis. To accomplish this the HDF5 data file, a list of perspective elements in the sample determined from broad spectrum analysis, and a minimum energy to consider must be provided to the ‘AOI_particle_analysis’ function. The function outputs an initial detector image from the data, which can then be cleaned to remove any dead or low intensity pixels that impede feature visualization via the color scale. After necessary cleaning, interactive plotting tools allow the precise location of the particle on the detector as well as the location on the same scan of ideal background signal to be inputted to extract a localized background subtracted spectrum.   

Localized, background subtracted spectra aid in resolving peaks that would otherwise be too weak to observe or index – an essential capability when characterizing dilute impurity concentrations. The function outputs the resulting spectra as well as a rough indexing of peaks, and autonomously identifies any elements from the broad-spectrum analysis with corresponding fluorescence energies via the ‘identify_element_match’ function. Users can then adjust the constraining peak parameters to be more inclusive or exclusive of peaks to focus on elements of interest. If desired, the function can even output a fit of the ROI background subtracted spectrum by fitting each peak to a gaussian along with a baseline using the ‘peak_fitting’ function. Finally, the function outputs as many detector mappings of the identified ROI as desired based on the energy ranges inputted to provide XRF detector mappings of individual elements within the particle.  

The results of this processing will be combined with quantitative analysis code to quantify the composition of the particle and that of any relevant impurities utilizing standard samples in terms of mass – the focus of FY24 analysis. This analysis entails a similar process as described above but for standard samples produced by micromatter. Using the ‘standard_data_extractor’ function, the known elemental area density on the sample is leveraged to calculate a calibration curve (Fig 15d) relating observed intensity of element peak(s) to mass. Spending the effort to improve the resolution of peaks in dilute spectra provides enhanced quantitative analysis capabilities that once full refined in FY24, will be invaluable moving forward.  
